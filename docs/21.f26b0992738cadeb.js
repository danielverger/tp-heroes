"use strict";(self.webpackChunkw2m_front=self.webpackChunkw2m_front||[]).push([[21],{9021:(pt,Z,a)=>{a.r(Z),a.d(Z,{HeroesModule:()=>mt});var p=a(1896),S=a(9887),H=a(3566),D=a(2438),Y=a(7398),I=a(3620),B=a(3997),M=a(3019),R=a(7921),y=a(9397),E=a(4664),t=a(5879),u=a(6306),Q=a(8504);class J{constructor(){this.pageIndex=0,this.pageSize=10,this.name="",this.sortField="name",this.sortDirection="asc"}}var T=a(9862);let b=(()=>{class o{get lastFilter(){return this._lastFilter}constructor(e){this.http=e,this._lastFilter=new J}getHeroes(e){this._lastFilter=e;let i=(new T.LE).set("pageIndex",e.pageIndex).set("pageSize",e.pageSize).set("sortField",e.sortField).set("sortDirection",e.sortDirection);return e.name&&(i=i.set("name",e.name)),this.http.get("heroes",{params:i}).pipe((0,u.K)(this.handleError))}getHero(e){return this.http.get(`heroes/${e}`).pipe((0,u.K)(this.handleError))}addHero(e){return this.http.post("heroes",e).pipe((0,u.K)(this.handleError))}modifyHero(e){return this.http.put(`heroes/${e.id}`,e).pipe((0,u.K)(this.handleError))}deleteHero(e){return this.http.delete(`heroes/${e}`).pipe((0,u.K)(this.handleError))}handleError(e){return(0,Q._)(()=>"Something bad happened; please try again later.")}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(T.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var z=a(5940);let $=(()=>{class o{constructor(){}static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-loader"]],decls:1,vars:0,consts:[[1,"loader"]],template:function(i,r){1&i&&t._UZ(0,"mat-spinner",0)},dependencies:[z.Ou]})}return o})();var m=a(7700),v=a(2296);let w=(()=>{class o{constructor(e,i){this.dialogRef=e,this.data=i}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(m.so),t.Y36(m.WI))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-dialog"]],decls:9,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","align","end",1,"p-3"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-button","",3,"mat-dialog-close"]],template:function(i,r){1&i&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2)(5,"button",3),t._uU(6,"No"),t.qZA(),t.TgZ(7,"button",4),t._uU(8,"Yes"),t.qZA()()),2&i&&(t.xp6(1),t.Oqu(r.data.title),t.xp6(2),t.hij(" ",r.data.message,"\n"),t.xp6(4),t.Q6J("mat-dialog-close",!0))},dependencies:[v.lW,m.ZT,m.uh,m.xY,m.H8]})}return o})();var x=a(2939);let A=(()=>{class o{constructor(e,i){this.dialog=e,this.snackBar=i,this.horizontalPosition="end",this.verticalPosition="top"}showLoading(){this.dialogRef||(this.dialogRef=this.dialog.open($,{disableClose:!0,panelClass:"loader-dialog"}))}closeLoading(){this.dialogRef?.close(),this.dialogRef=null}confirmDialog(e,i){return this.dialog.open(w,{width:"350px",data:{title:e,message:i}})}openSnackBar(e,i){const r=new x.u_;return r.duration="error"===i?2e3:1200,r.panelClass=`${i}-snackbar`,r.horizontalPosition=this.horizontalPosition,r.verticalPosition=this.verticalPosition,this.snackBar.open(e,"",r)}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(m.uw),t.LFG(x.ux))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var d=a(5195),F=a(6385),f=a(9157),G=a(617),N=a(2032),l=a(5313),O=a(2596),U=a(6814);const K=["inputName"];function k(o,s){1&o&&(t.TgZ(0,"th",15),t._uU(1," Id. "),t.qZA())}function P(o,s){if(1&o&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function j(o,s){1&o&&(t.TgZ(0,"th",15),t._uU(1," Name "),t.qZA())}function W(o,s){if(1&o&&(t.TgZ(0,"td",16),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)," ")}}function X(o,s){1&o&&t._UZ(0,"th",17)}const V=function(o){return[o]};function q(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"td",16)(1,"button",18),t.NdJ("click",function(){const n=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.deleteHero(n))}),t.TgZ(2,"mat-icon",19),t._uU(3,"delete"),t.qZA()(),t.TgZ(4,"button",20)(5,"mat-icon"),t._uU(6,"edit"),t.qZA()()()}if(2&o){const e=s.$implicit;t.xp6(4),t.Q6J("routerLink",t.VKq(1,V,e.id))}}function _(o,s){1&o&&t._UZ(0,"tr",21)}function tt(o,s){1&o&&t._UZ(0,"tr",22)}const et=function(){return["add"]},ot=function(){return[5,10,20]};let it=(()=>{class o{constructor(e,i,r){this.heroesService=e,this.modalService=i,this.cd=r,this.displayedColumns=["id","name","actions"],this.totalHeroes=0,this.heroesResult=[]}ngAfterViewInit(){const{pageIndex:e,pageSize:i,name:r,sortDirection:n,sortField:g}=this.heroesService.lastFilter;this.paginator.pageIndex=e,this.paginator.pageSize=i,this.inputName.nativeElement.value=r,this.sort.active=g,this.sort.direction=n,this.cd.detectChanges();const ht=(0,D.R)(this.inputName.nativeElement,"keyup").pipe((0,Y.U)(h=>h.target.value),(0,I.b)(500),(0,B.x)((h,C)=>h===C));this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,M.T)(ht,this.sort.sortChange,this.paginator.page).pipe((0,R.O)({}),(0,y.b)(()=>this.modalService.showLoading()),(0,E.w)(()=>this.heroesService.getHeroes({pageIndex:this.paginator.pageIndex,pageSize:this.paginator.pageSize,sortField:this.sort.active,sortDirection:this.sort.direction,name:this.inputName.nativeElement.value})),(0,y.b)(()=>this.modalService.closeLoading())).subscribe({next:({heroes:h,total:C})=>{this.heroesResult=h,this.totalHeroes=C},error:h=>{this.modalService.openSnackBar(h,"error"),this.modalService.closeLoading()}})}deleteHero(e){this.modalService.confirmDialog("Delete Hero",`Are you sure to delete ${e.name}?`).afterClosed().subscribe(i=>i&&this.heroesService.deleteHero(e.id).subscribe({next:r=>r&&this.modalService.openSnackBar(`${e.name} deleted!`,"info").afterOpened().subscribe(()=>{this.paginator.length=10,this.paginator.page.next(this.paginator)}),error:r=>this.modalService.openSnackBar(r,"error")}))}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(b),t.Y36(A),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-heroes-list"]],viewQuery:function(i,r){if(1&i&&(t.Gf(S.NW,5),t.Gf(H.YE,5),t.Gf(K,5)),2&i){let n;t.iGM(n=t.CRH())&&(r.paginator=n.first),t.iGM(n=t.CRH())&&(r.sort=n.first),t.iGM(n=t.CRH())&&(r.inputName=n.first)}},decls:29,vars:8,consts:[[1,"pt-3","pb-3"],[1,"d-flex","justify-content-between","pt-3"],["matInput","","placeholder","Hero name"],["inputName",""],["mat-stroked-button","",3,"routerLink"],["mat-table","","matSort","","matSortDisableClear","",1,"hero-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of heroes",3,"length","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","matTooltip","delete",3,"click"],["color","warn"],["mat-icon-button","","matTooltip","edit",3,"routerLink"],["mat-header-row",""],["mat-row",""]],template:function(i,r){1&i&&(t.TgZ(0,"mat-card")(1,"mat-card-header",0)(2,"mat-card-title"),t._uU(3,"Heroes"),t.qZA()(),t._UZ(4,"mat-divider"),t.TgZ(5,"mat-card-content")(6,"div",1)(7,"mat-form-field")(8,"mat-label"),t._uU(9,"Name"),t.qZA(),t._UZ(10,"input",2,3),t.qZA(),t.TgZ(12,"button",4)(13,"mat-icon"),t._uU(14,"add"),t.qZA(),t._uU(15," Add Hero "),t.qZA()(),t.TgZ(16,"table",5),t.ynx(17,6),t.YNc(18,k,2,0,"th",7),t.YNc(19,P,2,1,"td",8),t.BQk(),t.ynx(20,9),t.YNc(21,j,2,0,"th",7),t.YNc(22,W,3,3,"td",8),t.BQk(),t.ynx(23,10),t.YNc(24,X,1,0,"th",11),t.YNc(25,q,7,3,"td",8),t.BQk(),t.YNc(26,_,1,0,"tr",12),t.YNc(27,tt,1,0,"tr",13),t.qZA(),t._UZ(28,"mat-paginator",14),t.qZA()()),2&i&&(t.xp6(12),t.Q6J("routerLink",t.DdM(6,et)),t.xp6(4),t.Q6J("dataSource",r.heroesResult),t.xp6(10),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(1),t.Q6J("length",r.totalHeroes)("pageSizeOptions",t.DdM(7,ot)))},dependencies:[v.lW,v.RK,d.a8,d.dn,d.dk,d.n5,F.d,f.KE,f.hX,G.Hw,N.Nt,S.NW,H.YE,H.nU,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,O.gM,p.rH,U.rS],styles:[".hero-table[_ngcontent-%COMP%]{width:100%}.mat-column-actions[_ngcontent-%COMP%]{width:150px}"]})}return o})();var c=a(6223),rt=a(4300);const at=["inputName"];function nt(o,s){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Name is "),t.TgZ(2,"strong"),t._uU(3,"required"),t.qZA()())}const st=function(){return["/dashboard/heroes"]};let L=(()=>{class o{constructor(e,i,r,n,g){this.route=e,this.heroesService=i,this.modalService=r,this.router=n,this.formBuilder=g,this.isAddHero=!0,this.isSaving=!1}ngAfterViewInit(){}ngOnInit(){this.heroForm=this.formBuilder.group({name:["",c.kI.required],id:[{value:"",disabled:!0}]}),this.route.data.subscribe(e=>{this.titleCard=e.title}),this.route.paramMap.subscribe(e=>{if(e.get("id")){this.isAddHero=!1;const i=Number(e.get("id"));this.getHero(i)}})}getHero(e){this.modalService.showLoading(),this.heroesService.getHero(e).subscribe({next:i=>{i?(this.heroForm.patchValue(i),this.inputName.nativeElement.select()):this.modalService.openSnackBar(`Hero with id ${e} not exists`,"error").afterDismissed().subscribe(()=>this.router.navigate(["dashboard/heroes"]))},complete:()=>this.modalService.closeLoading(),error:i=>{this.modalService.closeLoading(),this.modalService.openSnackBar(i,"error")}})}saveHero(){this.isSaving=!0;const{id:e,name:i}=this.heroForm.getRawValue();(this.isAddHero?this.heroesService.addHero({id:e,name:i}):this.heroesService.modifyHero({id:e,name:i})).subscribe({next:n=>{this.modalService.openSnackBar(`Hero ${n.name} ${this.isAddHero?"added":"modified"}!!`,"info").afterDismissed().subscribe(()=>this.router.navigate(["dashboard/heroes"]))},error:n=>{this.modalService.openSnackBar(n,"error"),this.isSaving=!1}})}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(p.gz),t.Y36(b),t.Y36(A),t.Y36(p.F0),t.Y36(c.qu))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-hero-modify"]],viewQuery:function(i,r){if(1&i&&t.Gf(at,5),2&i){let n;t.iGM(n=t.CRH())&&(r.inputName=n.first)}},decls:24,vars:7,consts:[[3,"formGroup","ngSubmit"],[1,"pt-3","pb-3"],["cdkTrapFocus","",1,"pt-3","row",3,"cdkTrapFocusAutoCapture"],[1,"col-2"],["type","text","matInput","","formControlName","id"],[1,"col-6"],["oninput","this.value = this.value.toUpperCase()","type","text","matInput","","formControlName","name"],["inputName",""],[4,"ngIf"],["align","end",1,"p-3"],["mat-flat-button","","type","button",3,"routerLink"],["mat-flat-button","","type","submit","color","primary",3,"disabled"],["saveButton",""]],template:function(i,r){if(1&i&&(t.TgZ(0,"mat-card")(1,"form",0),t.NdJ("ngSubmit",function(){return r.saveHero()}),t.TgZ(2,"mat-card-header",1)(3,"mat-card-title"),t._uU(4),t.qZA()(),t._UZ(5,"mat-divider"),t.TgZ(6,"mat-card-content")(7,"div",2)(8,"mat-form-field",3)(9,"mat-label"),t._uU(10,"Id"),t.qZA(),t._UZ(11,"input",4),t.qZA(),t.TgZ(12,"mat-form-field",5)(13,"mat-label"),t._uU(14,"Name"),t.qZA(),t._UZ(15,"input",6,7),t.YNc(17,nt,4,0,"mat-error",8),t.qZA()()(),t.TgZ(18,"mat-card-actions",9)(19,"button",10),t._uU(20,"Cancel"),t.qZA(),t.TgZ(21,"button",11,12),t._uU(23,"Save"),t.qZA()()()()),2&i){let n;t.xp6(1),t.Q6J("formGroup",r.heroForm),t.xp6(3),t.Oqu(r.titleCard),t.xp6(3),t.Q6J("cdkTrapFocusAutoCapture",r.isAddHero),t.xp6(10),t.Q6J("ngIf",null==(n=r.heroForm.get("name"))?null:n.hasError("required")),t.xp6(2),t.Q6J("routerLink",t.DdM(6,st)),t.xp6(2),t.Q6J("disabled",r.heroForm.invalid||r.isSaving)}},dependencies:[rt.mK,v.lW,d.a8,d.hq,d.dn,d.dk,d.n5,F.d,f.KE,f.hX,f.TO,N.Nt,U.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,p.rH]})}return o})();const lt=[{path:"",component:it},{path:"add",component:L,data:{title:"Add Hero"}},{path:":id",component:L,data:{title:"Modify Hero"}}];let dt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[p.Bz.forChild(lt),p.Bz]})}return o})();var ct=a(7192);let mt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[ct.m,dt]})}return o})()}}]);